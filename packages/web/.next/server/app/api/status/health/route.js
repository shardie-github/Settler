"use strict";(()=>{var e={};e.id=945,e.ids=[945],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},59181:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>_,patchFetch:()=>v,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var a={};s.r(a),s.d(a,{GET:()=>p,dynamic:()=>u,revalidate:()=>c});var n=s(63036),r=s(5736),o=s(15262),i=s(82638),l=s(60942);let u="force-dynamic",c=0;async function p(){try{let e,t;let s=await (0,i.i)();try{let a=await s.rpc("get_kpi_health_status").single();e=a.data,t=a.error}catch(e){t=e}if(t){console.warn("RPC function not available, using fallback:",t);let[e,a,n]=await Promise.all([s.from("kpi_new_users_week").select("count").single(),s.from("kpi_actions_last_hour").select("count").single(),s.from("kpi_most_engaged_post_today").select("total_engagement").single()]),r=e.data?.count||0,o=a.data?.count||0,i=n.data?.total_engagement||0;return l.NextResponse.json({status:r>50&&o>100&&i>100?"Loud and High ✓":"Building Momentum",allCylindersFiring:r>50&&o>100&&i>100,kpis:{kpi1:{name:"New Users This Week",value:r,threshold:50,passed:r>50},kpi2:{name:"Actions Completed in Last Hour",value:o,threshold:100,passed:o>100},kpi3:{name:"Most Engaged Post Engagement",value:i,threshold:100,passed:i>100}},timestamp:new Date().toISOString()})}if(!e)return l.NextResponse.json({status:"Error",message:"Failed to fetch health status"},{status:500});let a=e,n={newUsersWeek:a.new_users_week||0,actionsLastHour:a.actions_last_hour||0,topPostEngagement:a.top_post_engagement||0,allCylindersFiring:a.all_cylinders_firing||!1},r=n.newUsersWeek>50,o=n.actionsLastHour>100,u=n.topPostEngagement>100,c=r&&o&&u;return l.NextResponse.json({status:c?"Loud and High ✓":"Building Momentum",allCylindersFiring:c,kpis:{kpi1:{name:"New Users This Week",value:n.newUsersWeek,threshold:50,passed:r},kpi2:{name:"Actions Completed in Last Hour",value:n.actionsLastHour,threshold:100,passed:o},kpi3:{name:"Most Engaged Post Engagement",value:n.topPostEngagement,threshold:100,passed:u}},timestamp:new Date().toISOString()},{status:200})}catch(e){return console.error("Health check error:",e),l.NextResponse.json({status:"Error",message:"Internal server error",error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let d=new n.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/status/health/route",pathname:"/api/status/health",filename:"route",bundlePath:"app/api/status/health/route"},resolvedPagePath:"/workspace/packages/web/src/app/api/status/health/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:h}=d,_="/api/status/health/route";function v(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},82638:(e,t,s)=>{s.d(t,{e:()=>r,i:()=>o});var a=s(66603),n=s(9362);async function r(){let e=await (0,n.cookies)(),t=process.env.SUPABASE_URL||process.env.NEXT_PUBLIC_SUPABASE_URL||"",s=process.env.SUPABASE_ANON_KEY||process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"";return t&&s||console.warn("Supabase environment variables not set - some features may not work"),(0,a.createServerClient)(t,s,{cookies:{get:t=>e.get(t)?.value,set(t,s,a){try{e.set({name:t,value:s,...a})}catch(e){}},remove(t,s){try{e.set({name:t,value:"",...s})}catch(e){}}}})}async function o(){let e=process.env.SUPABASE_URL||process.env.NEXT_PUBLIC_SUPABASE_URL||"",t=process.env.SUPABASE_SERVICE_ROLE_KEY||"";e&&t||console.warn("Supabase admin environment variables not set - admin features may not work");let{createClient:a}=await Promise.resolve().then(s.bind(s,65365));return a(e,t,{auth:{autoRefreshToken:!1,persistSession:!1}})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[522,920,746],()=>s(59181));module.exports=a})();