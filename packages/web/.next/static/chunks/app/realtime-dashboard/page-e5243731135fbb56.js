(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{5765:function(e,t,a){Promise.resolve().then(a.bind(a,5251))},5251:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return n}});var s=a(7573),r=a(7653),d=a(8831),l=a(141);function n(e){var t,a;let{params:n,searchParams:c}=e,o=(null==n?void 0:n.jobId)||(null==c?void 0:c.jobId)||"",i=(null==c?void 0:c.apiKey)||"",[x,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(null),[b,g]=(0,r.useState)([]),[p,k]=(0,r.useState)([]);(0,r.useEffect)(()=>{if(!o||!i)return;let e=new EventSource("/api/v1/realtime/reconciliations/".concat(o,"?token=").concat(encodeURIComponent(i)));return e.onopen=()=>{m(!0),j("Connected to real-time updates")},e.onmessage=t=>{try{let a=JSON.parse(t.data);"connected"===a.type?j("Connection established"):"execution_update"===a.type&&(h(a),j("Status update: ".concat(a.status)),a.error&&v(a.error),("completed"===a.status||"failed"===a.status)&&(e.close(),m(!1),j("Reconciliation finished. Connection closed.")))}catch(e){console.error("Failed to parse SSE message:",e)}},e.onerror=t=>{console.error("SSE error:",t),m(!1),j("Connection error. Attempting to reconnect..."),setTimeout(()=>{e.close(),window.location.reload()},5e3)},()=>{e.close()}},[o,i]);let j=e=>{g(t=>[...t.slice(-99),"".concat(new Date().toISOString(),": ").concat(e)])},v=e=>{k(t=>[...t.slice(-49),"".concat(new Date().toISOString(),": ").concat(e)])};return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900 dark:via-slate-800 dark:to-black",children:[(0,s.jsx)(d.Navigation,{}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 pt-24",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-6 text-slate-900 dark:text-white",children:"Reconciliation Dashboard"}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(x?"bg-green-500":"bg-red-500")}),(0,s.jsx)("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:x?"Connected":"Disconnected"})]})}),u&&(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-lg p-6 mb-6 border border-slate-200 dark:border-slate-700",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-slate-900 dark:text-white",children:"Execution Status"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-600 dark:text-slate-400",children:"Status:"}),(0,s.jsx)("span",{className:"ml-2 font-semibold ".concat((e=>{switch(e){case"completed":return"text-green-600 dark:text-green-400";case"failed":return"text-red-600 dark:text-red-400";case"running":return"text-blue-600 dark:text-blue-400";default:return"text-slate-600 dark:text-slate-400"}})(u.status)),children:null===(t=u.status)||void 0===t?void 0:t.toUpperCase()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-600 dark:text-slate-400",children:"Duration:"}),(0,s.jsx)("span",{className:"ml-2 font-semibold text-slate-900 dark:text-white",children:((e,t)=>{if(!e)return"N/A";let a=new Date(e),s=Math.floor(((t?new Date(t):new Date).getTime()-a.getTime())/1e3);return"".concat(Math.floor(s/60),"m ").concat(s%60,"s")})(u.startedAt,u.completedAt)})]}),u.startedAt&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-600 dark:text-slate-400",children:"Started:"}),(0,s.jsx)("span",{className:"ml-2 text-slate-900 dark:text-white",children:new Date(u.startedAt).toLocaleString()})]}),u.completedAt&&(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-slate-600 dark:text-slate-400",children:"Completed:"}),(0,s.jsx)("span",{className:"ml-2 text-slate-900 dark:text-white",children:new Date(u.completedAt).toLocaleString()})]})]}),u.summary&&(0,s.jsxs)("div",{className:"mt-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-3 text-slate-900 dark:text-white",children:"Summary"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded border border-blue-200 dark:border-blue-800",children:[(0,s.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Source Records"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:u.summary.total_source_records||0})]}),(0,s.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded border border-green-200 dark:border-green-800",children:[(0,s.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Target Records"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:u.summary.total_target_records||0})]}),(0,s.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded border border-purple-200 dark:border-purple-800",children:[(0,s.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Matches"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:u.summary.matched_count||0})]}),(0,s.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded border border-yellow-200 dark:border-yellow-800",children:[(0,s.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Unmatched Source"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:u.summary.unmatched_source_count||0})]}),(0,s.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-4 rounded border border-orange-200 dark:border-orange-800",children:[(0,s.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Unmatched Target"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:u.summary.unmatched_target_count||0})]}),(0,s.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded border border-red-200 dark:border-red-800",children:[(0,s.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Errors"}),(0,s.jsx)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:u.summary.errors_count||0})]})]}),null!==u.summary.accuracy_percentage&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Accuracy"}),(0,s.jsxs)("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:[null===(a=u.summary.accuracy_percentage)||void 0===a?void 0:a.toFixed(2),"%"]})]})]})]}),p.length>0&&(0,s.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-red-800 dark:text-red-300 mb-2",children:"Errors"}),(0,s.jsx)("div",{className:"max-h-48 overflow-y-auto",children:p.map((e,t)=>(0,s.jsx)("div",{className:"text-sm text-red-700 dark:text-red-400 mb-1",children:e},t))})]}),(0,s.jsxs)("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2 text-slate-900 dark:text-white",children:"Activity Log"}),(0,s.jsx)("div",{className:"max-h-64 overflow-y-auto font-mono text-sm text-slate-700 dark:text-slate-300",children:b.map((e,t)=>(0,s.jsx)("div",{className:"mb-1",children:e},t))})]})]}),(0,s.jsx)(l.$,{})]})}}},function(e){e.O(0,[443,151,293,528,744],function(){return e(e.s=5765)}),_N_E=e.O()}]);