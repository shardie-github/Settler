(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1964],{5765:function(e,t,r){Promise.resolve().then(r.bind(r,8317))},6438:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(2389).Z)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]])},269:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});let a=(0,r(2389).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},8146:function(e,t,r){"use strict";r.d(t,{default:function(){return s.a}});var a=r(6340),s=r.n(a)},8317:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return n}});var a=r(7573),s=r(8831),l=r(141),d=r(7653);function n(e){var t,r;let{params:n,searchParams:c}=e,o=(null==n?void 0:n.jobId)||(null==c?void 0:c.jobId)||"",i=(null==c?void 0:c.apiKey)||"",{connected:x,execution:m,logs:u,errors:h}=function(e){let{jobId:t,apiKey:r,enabled:a=!0,onUpdate:s,onError:l}=e,[n,c]=(0,d.useState)(!1),[o,i]=(0,d.useState)(null),[x,m]=(0,d.useState)([]),[u,h]=(0,d.useState)([]),b=(0,d.useRef)(null),g=(0,d.useRef)(null),k=(0,d.useCallback)(e=>{m(t=>[...t.slice(-99),"".concat(new Date().toISOString(),": ").concat(e)])},[]),p=(0,d.useCallback)(e=>{h(t=>[...t.slice(-49),"".concat(new Date().toISOString(),": ").concat(e)])},[]),v=(0,d.useCallback)(()=>{b.current&&(b.current.close(),b.current=null),g.current&&(clearTimeout(g.current),g.current=null),c(!1)},[]),j=(0,d.useCallback)(()=>{if(!t||!r||!a)return;v();let e=new EventSource("/api/v1/realtime/reconciliations/".concat(t,"?token=").concat(encodeURIComponent(r)));b.current=e,e.onopen=()=>{c(!0),k("Connected to real-time updates")},e.onmessage=e=>{try{let t=JSON.parse(e.data);"connected"===t.type?k("Connection established"):"execution_update"===t.type&&(i(t),k("Status update: ".concat(t.status)),null==s||s(t),t.error&&p(t.error),("completed"===t.status||"failed"===t.status)&&(v(),k("Reconciliation finished. Connection closed.")))}catch(e){console.error("Failed to parse SSE message:",e),p("Failed to parse update message")}},e.onerror=e=>{console.error("SSE error:",e),c(!1),k("Connection error. Attempting to reconnect..."),null==l||l(e instanceof Error?e:Error("SSE connection error")),g.current=setTimeout(()=>{j()},5e3)}},[t,r,a,k,p,s,l,v]);return(0,d.useEffect)(()=>(a&&t&&r&&j(),()=>{v()}),[a,t,r,j,v]),{connected:n,execution:o,logs:x,errors:u,reconnect:j,disconnect:v}}({jobId:o,apiKey:i,enabled:!!o&&!!i});return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 dark:from-slate-900 dark:via-slate-800 dark:to-black",children:[(0,a.jsx)(s.Navigation,{}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 pt-24",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-6 text-slate-900 dark:text-white",children:"Reconciliation Dashboard"}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(x?"bg-green-500":"bg-red-500")}),(0,a.jsx)("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:x?"Connected":"Disconnected"})]})}),m&&(0,a.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-lg p-6 mb-6 border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4 text-slate-900 dark:text-white",children:"Execution Status"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-slate-600 dark:text-slate-400",children:"Status:"}),(0,a.jsx)("span",{className:"ml-2 font-semibold ".concat((e=>{switch(e){case"completed":return"text-green-600 dark:text-green-400";case"failed":return"text-red-600 dark:text-red-400";case"running":return"text-blue-600 dark:text-blue-400";default:return"text-slate-600 dark:text-slate-400"}})(m.status)),children:null===(t=m.status)||void 0===t?void 0:t.toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-slate-600 dark:text-slate-400",children:"Duration:"}),(0,a.jsx)("span",{className:"ml-2 font-semibold text-slate-900 dark:text-white",children:((e,t)=>{if(!e)return"N/A";let r=new Date(e),a=Math.floor(((t?new Date(t):new Date).getTime()-r.getTime())/1e3);return"".concat(Math.floor(a/60),"m ").concat(a%60,"s")})(m.startedAt,m.completedAt)})]}),m.startedAt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-slate-600 dark:text-slate-400",children:"Started:"}),(0,a.jsx)("span",{className:"ml-2 text-slate-900 dark:text-white",children:new Date(m.startedAt).toLocaleString()})]}),m.completedAt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-slate-600 dark:text-slate-400",children:"Completed:"}),(0,a.jsx)("span",{className:"ml-2 text-slate-900 dark:text-white",children:new Date(m.completedAt).toLocaleString()})]})]}),m.summary&&(0,a.jsxs)("div",{className:"mt-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-3 text-slate-900 dark:text-white",children:"Summary"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded border border-blue-200 dark:border-blue-800",children:[(0,a.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Source Records"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:m.summary.total_source_records||0})]}),(0,a.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded border border-green-200 dark:border-green-800",children:[(0,a.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Target Records"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:m.summary.total_target_records||0})]}),(0,a.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded border border-purple-200 dark:border-purple-800",children:[(0,a.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Matches"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:m.summary.matched_count||0})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded border border-yellow-200 dark:border-yellow-800",children:[(0,a.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Unmatched Source"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:m.summary.unmatched_source_count||0})]}),(0,a.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-4 rounded border border-orange-200 dark:border-orange-800",children:[(0,a.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Unmatched Target"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:m.summary.unmatched_target_count||0})]}),(0,a.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded border border-red-200 dark:border-red-800",children:[(0,a.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Errors"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:m.summary.errors_count||0})]})]}),null!==m.summary.accuracy_percentage&&(0,a.jsxs)("div",{className:"mt-4",children:[(0,a.jsx)("div",{className:"text-sm text-slate-600 dark:text-slate-400 mb-1",children:"Accuracy"}),(0,a.jsxs)("div",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:[null===(r=m.summary.accuracy_percentage)||void 0===r?void 0:r.toFixed(2),"%"]})]})]})]}),h.length>0&&(0,a.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-red-800 dark:text-red-300 mb-2",children:"Errors"}),(0,a.jsx)("div",{className:"max-h-48 overflow-y-auto",children:h.map((e,t)=>(0,a.jsx)("div",{className:"text-sm text-red-700 dark:text-red-400 mb-1",children:e},t))})]}),(0,a.jsxs)("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2 text-slate-900 dark:text-white",children:"Activity Log"}),(0,a.jsx)("div",{className:"max-h-64 overflow-y-auto font-mono text-sm text-slate-700 dark:text-slate-300",children:u.map((e,t)=>(0,a.jsx)("div",{className:"mb-1",children:e},t))})]})]}),(0,a.jsx)(l.$,{})]})}}},function(e){e.O(0,[6340,1547,9151,1293,1528,1744],function(){return e(e.s=5765)}),_N_E=e.O()}]);